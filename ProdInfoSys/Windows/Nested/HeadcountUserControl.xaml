<UserControl x:Class="ProdInfoSys.Windows.Nested.HeadcountUserControl"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:local="clr-namespace:ProdInfoSys.Windows.Nested"
             xmlns:lvc="clr-namespace:LiveCharts.Wpf;assembly=LiveCharts.Wpf"
             xmlns:ViewModels="clr-namespace:ProdInfoSys.ViewModels.Nested"
             xmlns:Classes="clr-namespace:ProdInfoSys.Classes"
             mc:Ignorable="d"
             Loaded="UserControl_Loaded"
             d:DesignHeight="450" d:DesignWidth="800">
    <UserControl.Resources>
        <Classes:BindingProxy x:Key="Proxy" Data="{Binding}"/>        
    </UserControl.Resources>
    
    <UserControl.InputBindings>
        <KeyBinding Command="{Binding SaveDocument}" Modifiers="Ctrl" Key="S"/>
    </UserControl.InputBindings>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="30"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="7"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>
        <ToolBar Margin="2 0 2 2" Grid.Row="0">
            <Button Margin="0" Height="30" ToolTip="Mentés (Ctrl + S)" Command="{Binding SaveDocument}" >
                <StackPanel Orientation="Horizontal">
                    <Image Source="/img/icons8-save-25.png" />
                </StackPanel>
            </Button>
            <Separator/>
            <Button Margin="0" Height="30" ToolTip="Munkanap hozzáadása" Command="{Binding AddExtraWorkday}" >
                <StackPanel Orientation="Horizontal">
                    <Image Source="/img/icons8-workday-25.png" />
                </StackPanel>
            </Button>
            <DatePicker SelectedDate="{Binding ExtraWorkday}"/>
            <Separator/>
            <Button Margin="0" Height="30" ToolTip="Törlés" Command="{Binding DeleteSelected}" >
                <StackPanel Orientation="Horizontal">
                    <Image Source="/img/icons8-delete-25.png" />
                </StackPanel>
            </Button>
            <Separator/>
            <Button Margin="0" Height="30" ToolTip="Excel export" Command="{Binding ExportExcel}" >
                <StackPanel Orientation="Horizontal">
                    <Image Source="/img/icons8-xls-export-25.png" />
                </StackPanel>
            </Button>
            <Separator/>
            <TextBlock Text="{Binding MustSave}" VerticalAlignment="Center" FontFamily="Consolas" FontWeight="Bold" Foreground="Red" FontSize="20" Margin="10 0 10 0"/>
        </ToolBar>
        <DataGrid 
            Grid.Row="1" 
            FrozenColumnCount="1"
            AutoGenerateColumns="False" 
            ItemsSource="{Binding HeadCountFollowupDocuments, Mode=TwoWay}" 
            Margin="2 0 2 2" 
            HorizontalScrollBarVisibility="Auto" 
            SelectedItem="{Binding SelectedDocument}"
            x:Name="DataGrid"
            VerticalScrollBarVisibility="Auto">
            <DataGrid.ColumnHeaderStyle>
                <Style TargetType="DataGridColumnHeader">
                    <Setter Property="FontFamily" Value="Consolas"/>
                    <Setter Property="FontSize" Value="13"/>
                    <Setter Property="FontWeight" Value="Bold"/>
                    
                </Style>
            </DataGrid.ColumnHeaderStyle>
            <DataGrid.RowStyle>
                <Style TargetType="DataGridRow">
                    <Setter Property="FontFamily" Value="Consolas"/>
                    <Setter Property="Foreground" Value="#38757a"/>
                    <Setter Property="Background" Value="#eef6f7"/>
                    <Setter Property="FontSize" Value="{Binding Data.FontSize, Source={StaticResource Proxy}}"/>
                </Style>
            </DataGrid.RowStyle>
            <DataGrid.Columns>
                <DataGridTextColumn Header="Munkanap" Binding="{Binding Workday, StringFormat=\{0:yyyy-MM-dd\}}" IsReadOnly="True">

                    <DataGridTextColumn.CellStyle>
                        <Style TargetType="DataGridCell">
                            <Setter Property="Background" Value="#ccf2ff"/>
                            <Setter Property="Foreground" Value="#007399"/>
                            <Style.Triggers>
                                <Trigger Property="IsSelected" Value="True">
                                    <Setter Property="Foreground" Value="Black"/>
                                </Trigger>
                            </Style.Triggers>
                        </Style>
                    </DataGridTextColumn.CellStyle>
                </DataGridTextColumn>
                <DataGridTextColumn Header="Netto HC terv" Binding="{Binding NettoHCPlan, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
                <DataGridTextColumn Header="Brutto HC terv" Binding="{Binding HCPlan, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                <DataGridTextColumn Header="Aktuális HC" Binding="{Binding ActualHC, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
                <DataGridTextColumn Header="Alvállalkozó" Binding="{Binding Subcontactor, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                <DataGridTextColumn Header="Egyéb" Binding="{Binding Others, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                <DataGridTextColumn Header="FFC Indirekt" Binding="{Binding FFCIndirect, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
                <DataGridTextColumn Header="QA Indirekt" Binding="{Binding QAIndirect, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
                <DataGridTextColumn Header="FFC Direkt + Indirekt" Binding="{Binding FFCDirectPlusIndirect,UpdateSourceTrigger=PropertyChanged}" IsReadOnly="True">
                    <DataGridTextColumn.CellStyle>
                        <Style TargetType="DataGridCell">
                            <Setter Property="Background" Value="#ccf2ff"/>
                            <Setter Property="Foreground" Value="#007399"/>
                            <Style.Triggers>
                                <Trigger Property="IsSelected" Value="True">
                                    <Setter Property="Foreground" Value="Black"/>
                                </Trigger>
                            </Style.Triggers>
                        </Style>
                    </DataGridTextColumn.CellStyle>
                </DataGridTextColumn>
                <!--
                    <DataGridTextColumn Header="Napi HC terv" Binding="{Binding DailyHCPlanAvg,UpdateSourceTrigger=PropertyChanged}" IsReadOnly="True"/>
                    -->
                <DataGridTextColumn Header="Szabi" Binding="{Binding Holiday, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
                <DataGridTextColumn Header="Beteg" Binding="{Binding Sick, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
                <DataGridTextColumn Header="Különbség" Binding="{Binding Diff, UpdateSourceTrigger=PropertyChanged}" IsReadOnly="True">
                    <DataGridTextColumn.CellStyle>
                        <Style TargetType="DataGridCell">
                            <Setter Property="Background" Value="#ccf2ff"/>
                            <Setter Property="Foreground" Value="#007399"/>
                            <Style.Triggers>
                                <Trigger Property="IsSelected" Value="True">
                                    <Setter Property="Foreground" Value="Black"/>
                                </Trigger>
                            </Style.Triggers>
                        </Style>
                    </DataGridTextColumn.CellStyle>
                </DataGridTextColumn>
                <DataGridTextColumn Header="Tervezett munkaóra" Binding="{Binding CalcPlannedSH, UpdateSourceTrigger=PropertyChanged}" IsReadOnly="True">
                    <DataGridTextColumn.CellStyle>
                        <Style TargetType="DataGridCell">
                            <Setter Property="Background" Value="#ccf2ff"/>
                            <Setter Property="Foreground" Value="#007399"/>
                            <Style.Triggers>
                                <Trigger Property="IsSelected" Value="True">
                                    <Setter Property="Foreground" Value="Black"/>
                                </Trigger>
                            </Style.Triggers>
                        </Style>
                    </DataGridTextColumn.CellStyle>
                </DataGridTextColumn>
                <DataGridTextColumn Header="Aktuális munkaóra" Binding="{Binding CalcActualSH, UpdateSourceTrigger=PropertyChanged}" IsReadOnly="True">
                    <DataGridTextColumn.CellStyle>
                        <Style TargetType="DataGridCell">
                            <Setter Property="Background" Value="#ccf2ff"/>
                            <Setter Property="Foreground" Value="#007399"/>
                            <Style.Triggers>
                                <Trigger Property="IsSelected" Value="True">
                                    <Setter Property="Foreground" Value="Black"/>
                                </Trigger>
                            </Style.Triggers>
                        </Style>
                    </DataGridTextColumn.CellStyle>
                </DataGridTextColumn>
            </DataGrid.Columns>
        </DataGrid>
        <GridSplitter Grid.Row="2" HorizontalAlignment="Stretch" Background="#4DA1A9" Margin="2 2 2 2"/>
        <Grid Grid.Row="3" Margin="2">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>
            <Grid.RowDefinitions>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>
            <TabControl>
                <TabItem Header="Létszám nyomonkövetés">
                    <lvc:CartesianChart Series="{Binding SeriesCollection}" LegendLocation="Bottom">
                        <lvc:CartesianChart.AxisX>
                            <lvc:Axis Title="Munkanap" Labels="{Binding Labels}" >
                                <lvc:Axis.Separator>
                                    <lvc:Separator Step="1" IsEnabled="False"/>
                                </lvc:Axis.Separator>
                            </lvc:Axis>
                        </lvc:CartesianChart.AxisX>
                        <lvc:CartesianChart.AxisY>
                            <lvc:Axis Title="Létszám" />
                        </lvc:CartesianChart.AxisY>
                    </lvc:CartesianChart>
                </TabItem>

                <TabItem Header="Hiányzás nyomonkövetés">
                    <lvc:CartesianChart Series="{Binding AbsenseSeriesCollection}" LegendLocation="Bottom">
                        <lvc:CartesianChart.AxisX>
                            <lvc:Axis Title="Munkanap" Labels="{Binding Labels}" >
                                <lvc:Axis.Separator>
                                    <lvc:Separator Step="1" IsEnabled="False"/>
                                </lvc:Axis.Separator>
                            </lvc:Axis>
                        </lvc:CartesianChart.AxisX>
                        <lvc:CartesianChart.AxisY>
                            <lvc:Axis Title="Létszám" />
                        </lvc:CartesianChart.AxisY>
                    </lvc:CartesianChart>
                </TabItem>
                <TabItem Header="Munkaóra nyomonkövetés">
                    <lvc:CartesianChart Series="{Binding WorkTimeSeriesCollection}" LegendLocation="Bottom">
                        <lvc:CartesianChart.AxisX>
                            <lvc:Axis Title="Munkanap" Labels="{Binding Labels}" >
                                <lvc:Axis.Separator>
                                    <lvc:Separator Step="1" IsEnabled="False"/>
                                </lvc:Axis.Separator>
                            </lvc:Axis>
                        </lvc:CartesianChart.AxisX>
                        <lvc:CartesianChart.AxisY>
                            <lvc:Axis Title="Munkaóra" />
                        </lvc:CartesianChart.AxisY>
                    </lvc:CartesianChart>
                </TabItem>
            </TabControl>
        </Grid>
    </Grid>
</UserControl>
